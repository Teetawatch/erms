@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
    *,
    *::before,
    *::after {
        @apply border-erms-border;
    }

    html {
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        text-rendering: optimizeLegibility;
    }

    body {
        @apply bg-erms-bg text-erms-text font-sans antialiased text-sm leading-relaxed;
    }

    ::selection {
        @apply bg-erms-blue/20 text-erms-text;
    }

    :focus-visible {
        @apply outline-2 outline-offset-2 outline-erms-blue;
    }

    ::-webkit-scrollbar {
        width: 6px;
        height: 6px;
    }
    ::-webkit-scrollbar-track {
        @apply bg-transparent;
    }
    ::-webkit-scrollbar-thumb {
        @apply bg-erms-border rounded-full;
    }
    ::-webkit-scrollbar-thumb:hover {
        @apply bg-erms-muted;
    }
}

@layer components {
    /* ─── Buttons ─── */
    .btn-primary {
        @apply inline-flex items-center justify-center gap-1.5 px-4 py-2 text-sm font-medium text-white bg-erms-blue rounded-md transition-all duration-150 cursor-pointer;
    }
    .btn-primary:hover {
        @apply bg-erms-blue/90;
    }
    .btn-primary:active {
        @apply scale-[0.98];
    }
    .btn-primary:focus-visible {
        @apply ring-2 ring-erms-blue/40 ring-offset-2;
    }

    .btn-secondary {
        @apply inline-flex items-center justify-center gap-1.5 px-4 py-2 text-sm font-medium text-erms-text border border-erms-border bg-white rounded-md transition-all duration-150 cursor-pointer hover:bg-erms-surface-2 hover:border-erms-muted/40;
    }
    .btn-secondary:active {
        @apply scale-[0.98];
    }

    .btn-danger {
        @apply inline-flex items-center justify-center gap-1.5 px-4 py-2 text-sm font-medium text-white bg-erms-red rounded-md transition-all duration-150 cursor-pointer hover:bg-erms-red/90;
    }

    .btn-ghost {
        @apply inline-flex items-center justify-center gap-1.5 px-3 py-1.5 text-sm font-medium text-erms-text-secondary rounded-md transition-all duration-150 cursor-pointer hover:bg-erms-surface-2;
    }

    .btn-icon {
        @apply inline-flex items-center justify-center w-8 h-8 text-erms-muted rounded-md transition-all duration-100 cursor-pointer hover:bg-erms-surface-2 hover:text-erms-text;
    }

    /* ─── Cards (Asana-style) ─── */
    .card {
        @apply bg-erms-surface rounded-lg border border-erms-border-light shadow-asana-card transition-all duration-150;
    }
    .card-hover:hover {
        @apply shadow-asana-card-hover border-erms-border;
    }

    /* ─── Inputs ─── */
    .input-field {
        @apply w-full bg-white border border-erms-border rounded-md px-3 py-2 text-erms-text placeholder-erms-muted text-sm transition-all duration-150 focus:border-erms-blue focus:ring-2 focus:ring-erms-blue/10 focus:outline-none;
    }

    /* ─── Priority Badges (Asana-style pill) ─── */
    .badge-urgent {
        @apply inline-flex items-center gap-1 px-2 py-0.5 text-2xs font-semibold rounded-full bg-erms-red-light text-erms-red;
    }
    .badge-high {
        @apply inline-flex items-center gap-1 px-2 py-0.5 text-2xs font-semibold rounded-full bg-erms-orange-light text-erms-orange;
    }
    .badge-medium {
        @apply inline-flex items-center gap-1 px-2 py-0.5 text-2xs font-semibold rounded-full bg-erms-yellow-light text-erms-yellow;
    }
    .badge-low {
        @apply inline-flex items-center gap-1 px-2 py-0.5 text-2xs font-semibold rounded-full bg-erms-green-light text-erms-green;
    }

    /* ─── Status Badges ─── */
    .badge-todo {
        @apply inline-flex items-center gap-1 px-2 py-0.5 text-2xs font-semibold rounded-full bg-erms-surface-2 text-erms-muted border border-erms-border;
    }
    .badge-in-progress {
        @apply inline-flex items-center gap-1 px-2 py-0.5 text-2xs font-semibold rounded-full bg-erms-blue-light text-erms-blue;
    }
    .badge-review {
        @apply inline-flex items-center gap-1 px-2 py-0.5 text-2xs font-semibold rounded-full bg-erms-purple-light text-erms-purple;
    }
    .badge-done {
        @apply inline-flex items-center gap-1 px-2 py-0.5 text-2xs font-semibold rounded-full bg-erms-green-light text-erms-green;
    }

    /* ─── Progress Bar ─── */
    .progress-bar {
        @apply h-1.5 rounded-full bg-erms-surface-2 overflow-hidden;
    }
    .progress-bar .fill {
        @apply h-full rounded-full bg-erms-green transition-all duration-300;
    }

    /* ─── Sidebar Links (Dark Asana sidebar) ─── */
    .sidebar-link {
        @apply flex items-center gap-2.5 px-3 py-[7px] rounded-md text-[13px] text-erms-sidebar-text transition-all duration-100 cursor-pointer;
    }
    .sidebar-link:hover {
        @apply bg-erms-sidebar-hover text-erms-sidebar-text-active;
    }
    .sidebar-link.active {
        @apply bg-erms-sidebar-active text-erms-sidebar-text-active font-medium;
    }
    .sidebar-link .sidebar-icon {
        @apply w-4 h-4 flex-shrink-0 opacity-70;
    }
    .sidebar-link.active .sidebar-icon {
        @apply opacity-100;
    }

    /* ─── Asana Task Row (List View) ─── */
    .task-row {
        @apply flex items-center px-4 py-2 border-b border-erms-border-light transition-colors duration-75 cursor-pointer;
    }
    .task-row:hover {
        @apply bg-erms-surface-2/60;
    }

    /* ─── Asana Kanban Card ─── */
    .kanban-card {
        @apply bg-white rounded-lg border border-erms-border-light p-3 cursor-grab shadow-asana-card transition-all duration-150;
    }
    .kanban-card:hover {
        @apply shadow-asana-card-hover border-erms-border;
    }
    .kanban-card:active {
        @apply cursor-grabbing shadow-asana-lg rotate-[1deg];
    }

    /* ─── Slide-in Panel (Task Detail) ─── */
    .slide-panel {
        @apply fixed top-0 right-0 h-full bg-white border-l border-erms-border shadow-asana-lg z-50 overflow-y-auto;
        width: min(640px, 100vw - 48px);
    }

    /* ─── Modal Overlay ─── */
    .modal-overlay {
        @apply fixed inset-0 z-50 bg-black/40 flex items-center justify-center backdrop-blur-[2px];
    }
    .modal-content {
        @apply bg-white rounded-xl shadow-asana-lg w-full max-w-lg mx-4 animate-scale-in;
    }

    /* ─── Tooltip ─── */
    .tooltip {
        @apply absolute z-50 px-2 py-1 text-xs font-medium text-white bg-erms-text rounded-md shadow-asana pointer-events-none;
    }

    /* ─── Search Bar (Asana-style) ─── */
    .search-bar {
        @apply flex items-center gap-2 bg-erms-surface-2 rounded-md px-3 py-1.5 text-sm text-erms-muted transition-all duration-150 border border-transparent;
    }
    .search-bar:focus-within {
        @apply bg-white border-erms-blue ring-2 ring-erms-blue/10;
    }

    /* ─── View Tabs (Asana-style) ─── */
    .view-tab {
        @apply flex items-center gap-1.5 px-3 py-1.5 text-[13px] font-medium text-erms-text-secondary rounded-md transition-all duration-100 cursor-pointer border border-transparent;
    }
    .view-tab:hover {
        @apply bg-erms-surface-2 text-erms-text;
    }
    .view-tab.active {
        @apply bg-white text-erms-text border-erms-border shadow-asana;
    }

    /* ─── Status Dot ─── */
    .status-dot {
        @apply w-2.5 h-2.5 rounded-full flex-shrink-0;
    }

    /* ─── Checkbox (Asana-style circle) ─── */
    .task-checkbox {
        @apply w-[18px] h-[18px] rounded-full border-2 border-erms-border flex-shrink-0 flex items-center justify-center cursor-pointer transition-all duration-100;
    }
    .task-checkbox:hover {
        @apply border-erms-green bg-erms-green/10;
    }
    .task-checkbox.checked {
        @apply border-erms-green bg-erms-green;
    }

    /* ─── Avatar Stack ─── */
    .avatar-stack {
        @apply flex -space-x-1.5;
    }
    .avatar-stack img {
        @apply w-6 h-6 rounded-full ring-2 ring-white;
    }

    /* ─── Quick Add ─── */
    .quick-add-fab {
        @apply fixed bottom-6 right-6 z-40 w-12 h-12 rounded-full bg-erms-blue text-white shadow-asana-lg flex items-center justify-center cursor-pointer transition-all duration-200;
    }
    .quick-add-fab:hover {
        @apply scale-110 shadow-[0_8px_32px_rgba(69,115,210,0.4)];
    }
    .quick-add-fab:active {
        @apply scale-95;
    }

    /* ─── Skeleton Loading ─── */
    .skeleton {
        background: linear-gradient(90deg, #f1f3f5 25%, #e8ecee 50%, #f1f3f5 75%);
        background-size: 200% 100%;
        @apply rounded-md animate-shimmer;
    }

    /* ─── Divider ─── */
    .divider {
        @apply border-t border-erms-border-light;
    }
}

/* ─── Transition Utilities ─── */
.animate-fade-in {
    @apply animate-fade-in-up;
}

/* ─── Drag & Drop States ─── */
.sortable-ghost {
    @apply opacity-30;
}
.sortable-drag {
    @apply rotate-[2deg] shadow-asana-lg;
}
.sortable-chosen {
    @apply shadow-asana-md;
}

/* ─── x-cloak ─── */
[x-cloak] {
    display: none !important;
}
